<div id = "Dashboard">
  <div class="container">

      <form [formGroup]="form" (ngSubmit)=" addProduct()" *ngIf="toAdd" enctype="multipart/form-data">

      <div class="row">
        <div class="col-25">
          <label>Name</label>
        </div>
        <div class="col-75">
          <input formControlName="name" type="text"  placeholder="Enter the name of the product">
        </div>
      </div>

      <div class="row">
        <div class="col-25">
          <label>Description</label>
        </div>
        <div class="col-75">
          <input formControlName="description" type="text"  placeholder="Enter the description of the product">
        </div>
      </div>

      <div class="row">
        <div class="col-25">
          <label>Picture</label>
        </div>
        <div class="col-75">
          <input type="file" formControlName="picture" (change)="fileChange($event)" placeholder="Upload file" accept=".jpg,.jpeg,.png">
        </div>
      </div>

      <div class="row">
        <div class="col-25">
          <label>Price in CAD</label>
        </div>
        <div class="col-75">
          <input formControlName="price" type="number"  placeholder="Enter the price of the product">
        </div>
      </div>

      <div class="row">
        <div class="col-25">
          <label>Discount</label>
        </div>
        <div class="col-75">
          <input formControlName="discount" type="number"  placeholder="Enter the discount of the product">
        </div>
      </div>

      <div class="row">
          <div class="col-25">
            <label>Quantity</label>
          </div>
          <div class="col-75">
            <input formControlName="quantity" type="number"  placeholder="Enter the quantity of the product">
          </div>
        </div>

        <div class="row">
          <div class="col-25">
              <label>Size</label>
          </div>
          <div class="col-75">
              <!-- <input type="radio" formControlName="size" value="XS">
              <label>XS</label>
              <input type="radio" formControlName="size" value="S">
              <label>S</label>
              <input type="radio" formControlName="size" value="M">
              <label>M</label>
              <input type="radio" formControlName="size" value="L">
              <label>L</label>
              <input type="radio" formControlName="size" value="XL">
              <label>XL</label> -->
              <input type="text" formControlName="size" placeholder="Enter the size of the product">
          </div>
      </div>

      <div class="row">
        <div class="col-25">
            <label>Color</label>
        </div>
        <div class="col-75">
            <!-- <input type="radio" formControlName="color" value="LIGHT_BLUE">
            <label>Light Blue</label>
            <input type="radio" formControlName="color" value="BLUE">
            <label>Blue</label>
            <input type="radio" formControlName="color" value="BLACK">
            <label>Black</label> -->
            <input type="text" formControlName="color" placeholder="Enter the color of the product">
        </div>
    </div>

    <div formArrayName="categories">
      <div class="arrayform">
      <!-- <div class="row"> -->
      
      <div class="form-group"
          *ngFor="let category of form.get('categories').controls; let i=index" >
          <div class = "row">
          <label class="col-25 control-label" [attr.for]="i">Category</label>

          <div class="col-50">
              <input class="form-control" 
                      [id]="i" 
                      type="text" 
                      placeholder="category" 
                      [formControlName]="i" />
          </div>
         <div class="col-25">
          <button class="col-md-6 btn btn-default"
                  type="button"
                  (click)="deleteCategory(i)">Delete
          </button>
        </div>
        </div>
        <!-- </div> -->
      </div>
      <div class="row">
          <button class="col-md-2 btn btn-default"
                  type="button"
                  (click)="addCategory()">Add Category
          </button>
      </div>
    </div>
  </div>

        <br>

      <div class="row">
        <input class="col-md-2 btn btn-default" type="submit" value="Add Product">
      </div>

    </form>

    <form [formGroup]="form" (ngSubmit)=" updateProduct()" *ngIf="toUpdate">

      <div class="row">
        <div class="col-25">
          <label>Name</label>
        </div>
        <div class="col-75">
          <input formControlName="name" type="text"  placeholder="Enter the name of the product">
        </div>
      </div>

      <div class="row">
        <div class="col-25">
          <label>Description</label>
        </div>
        <div class="col-75">
          <input formControlName="description" type="text"  placeholder="Enter the description of the product">
        </div>
      </div>

      <div class="row">
        <div class="col-25">
          <label>Picture</label>
        </div>
        <div class="col-75">
          <img src={{product.picture}} width="100px" height="100px" *ngIf="!showchangeImage">
          <button class="col-md-6 btn btn-default"
                  type="button"
                  (click)="changeImage()" *ngIf="!showchangeImage">Change Image
          </button>
          <input type="file" formControlName="picture" (change)="fileChange($event)" placeholder="Upload file" accept=".jpg,.jpeg,.png" *ngIf="showchangeImage">
        </div>
      </div>

      <div class="row">
        <div class="col-25">
          <label>Price in CAD</label>
        </div>
        <div class="col-75">
          <input formControlName="price" type="number"  placeholder="Enter the price of the product">
        </div>
      </div>

      <div class="row">
        <div class="col-25">
          <label>Discount</label>
        </div>
        <div class="col-75">
          <input formControlName="discount" type="number"  placeholder="Enter the discount of the product">
        </div>
      </div>

      <div class="row">
          <div class="col-25">
            <label>Quantity</label>
          </div>
          <div class="col-75">
            <input formControlName="quantity" type="number"  placeholder="Enter the quantity of the product">
          </div>
        </div>

        <div class="row">
          <div class="col-25">
              <label>Size</label>
          </div>
          <div class="col-75">
              <!-- <input type="radio" formControlName="size" value="XS">
              <label>XS</label>
              <input type="radio" formControlName="size" value="S">
              <label>S</label>
              <input type="radio" formControlName="size" value="M">
              <label>M</label>
              <input type="radio" formControlName="size" value="L">
              <label>L</label>
              <input type="radio" formControlName="size" value="XL">
              <label>XL</label> -->
              <input type="text" formControlName="size" placeholder="Enter the size of the product">
          </div>
      </div>

      <div class="row">
        <div class="col-25">
            <label>Color</label>
        </div>
        <div class="col-75">
            <!-- <input type="radio" formControlName="color" value="LIGHT_BLUE">
            <label>Light Blue</label>
            <input type="radio" formControlName="color" value="BLUE">
            <label>Blue</label>
            <input type="radio" formControlName="color" value="BLACK">
            <label>Black</label> -->
            <input type="text" formControlName="color" placeholder="Enter the color of the product">
        </div>
    </div>

    <div formArrayName="categories">
      <div class="arrayform">
      <!-- <div class="row"> -->
      
      <div class="form-group"
          *ngFor="let category of form.get('categories').controls; let i=index" >
          <div class = "row">
          <label class="col-25 control-label" [attr.for]="i">Category</label>

          <div class="col-50">
              <input class="form-control" 
                      [id]="i" 
                      type="text" 
                      placeholder="category" 
                      [formControlName]="i" />
          </div>
         <div class="col-25">
          <button class="col-md-6 btn btn-default"
                  type="button"
                  (click)="deleteCategory(i)">Delete
          </button>
        </div>
        </div>
        <!-- </div> -->
      </div>
      <div class="row">
          <button class="col-md-2 btn btn-default"
                  type="button"
                  (click)="addCategory()">Add Category
          </button>
      </div>
    </div>
  </div>

        <br>


        <div class="row">
          <input class="col-md-2 btn btn-default" type="submit" value="Update Product">
        </div>

    </form>

    <br>
    <br>
    
    <div class="alert" >
        {{message}}
      </div>
  </div>

  


  
      <div class="row" id="products">
        <div class="col-md-3" *ngFor="let productItem of products">
          <div class="card mb-3 shadow-sm">
            <!-- https://www.realmenrealstyle.com/wp-content/uploads/2021/07/mens-jeans.jpg -->
            <img class="bd-placeholder-img card-img-top p-2" src="{{ productItem.picture }}" width="100%"/>
          
            <div class="card-body">
              <p class="card-text">
                <!-- (productItem.price.amount / 100) | currency:'CAD' -->
                <strong>{{ (productItem.price.amount / 100) | currency:'CAD' }}</strong>
                <br />
                <strong>Quantity: {{ productItem.quantity }}</strong>
                <br />
                <strong *ngIf="productItem.discount > 0">Discount: {{ productItem.discount }}</strong>
              </p>
              <p class="card-text">{{ productItem.description | slice: 0:50 }}...</p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                  <button (click)="showUpdate(productItem)"
                          class="btn btn-sm btn-primary product-btn"
                          type="button"
                  >Update
                  </button>
                  <button (click)="deleteProduct(productItem.id)"
                          class="btn btn-sm btn-primary product-btn"
                          type="button"
                  >Delete
                  </button>
                  <button (click)="triggerModal(modalData, productItem)" class="btn btn-sm btn-outline-secondary product-btn"
                          type="button">View Details
                  </button>
                </div>
              </div>
            </div>
          
        </div>
      </div>
    </div>

 
  
    <ng-template #modalData let-modal>
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">{{showProduct.name}}</h4>
        <button (click)="modal.dismiss('Cross click')" aria-label="Close" class="close" type="button">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <div class="modal-body">
        <h2>{{ (showProduct.price.amount / 100) | currency:'CAD' }}</h2>
        <h2 *ngIf="showProduct.discount!=0" id="discount">{{showProduct.discount}}% Discount!!</h2>
        <p>Quantity: {{showProduct.quantity}}</p>
        <p>Details: {{showProduct.description}}</p>
        <p>Size: {{showProduct.size}}</p>
        <p>Color: {{showProduct.color}}</p>
        <p>Categories: </p>
        <ul *ngFor="let category of showProduct.categories">
          <li>{{category}}</li>
        </ul>
      </div>
      <div class="modal-footer">
        <button (click)="modal.close('Save click')" class="btn btn-danger" type="button">Close</button>
      </div>
    </ng-template>
  


</div>
